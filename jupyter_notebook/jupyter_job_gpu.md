## Notebooks on GPUs (use GPUs on your notebook) 

Template here: [gpu_jupyter_notebook.job](https://github.com/gmihaila/unt_hpc/blob/master/jupyter_notebook/gpu_jupyter_notebook.job)
      
 ## Run as a job file 

  ### Login to Talon:

```
$ ssh YOUR_EUID@talon3.hpc.unt.edu
```

### Create and configure your .job file:

Now you will need to create a .job file just like a batch submisison job (Check [this](https://github.com/gmihaila/unt_hpc/tree/master/job_batch) out if not familiar with job submissions on Talon)
Your .job file should look like this:

```
  #!/bin/bash
#SBATCH -J jupyter
#SBATCH -o job_%j.out
#SBATCH -p public
#SBATCH --qos general
#SBATCH -N 1
#SBATCH --gres=gpu:4
#SBATCH --mail-type=begin
#SBATCH --mail-user=username@my.unt.edu


module load pytorch/1.0.1

unset XDG_RUNTIME_DIR
jupyter notebook --no-browser --ip=0.0.0.0

```


[This](https://github.com/gmihaila/unt_hpc/blob/master/jupyter_notebook/jupyter_notebook.job) is a job example file that you can use to start. You can add/remove resources or functionality to it just like with any job file.

The part that is very important for Jupyter Notebook in the job file is:


```
  module load pytorch/1.0.1

  unset XDG_RUNTIME_DIR
  jupyter notebook --no-browser --ip=0.0.0.0
```

Once you have the job file ready, you can launch it just like any job file on talon


```
  $ sbatch YOUR_JOB_FILE.job
```

If you use this template file for example:

```
  $ sbatch gpu_jupyter_notebook.job
```


This will launch your job supporting Jupyter Notebooks. We need to find the compute node where the notebooks is running. For this we will use the output file generated by the job file (For example: job_JOB_ID.out) should look like:



```
[I 12:33:10.043 NotebookApp] Serving notebooks from local directory: /home/gm0234
[I 12:33:10.043 NotebookApp] The Jupyter Notebook is running at:
[I 12:33:10.043 NotebookApp] http://(YOUR_NODE_ADDRESS or 127.0.0.1):YOUR_PORT_NUMBER/
[I 12:33:10.043 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).

```

As an example:

```
[I 12:33:10.043 NotebookApp] Serving notebooks from local directory: /home/gm0234
[I 12:33:10.043 NotebookApp] The Jupyter Notebook is running at:
[I 12:33:10.043 NotebookApp] http://(gpu-8-7-1 or 127.0.0.1):8888/
[I 12:33:10.043 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).

```


The part we care about is:

```
[I 12:33:10.043 NotebookApp] http://(gpu-8-7-1 or 127.0.0.1):8888/

```

More exactly:

```
(gpu-8-7-1 or 127.0.0.1):8888/

```

From this we know the **YOUR_NODE_ADDRESS**: 

```
gpu-8-7-1

```
And **YOUR_PORT_NUMBER**:

```
8888

```

Having these 2 (YOUR_NODE_ADDRESS and YOUR_PORT_NUMBER) we can open a new terminal and login to forward that address to your local machine:

```
$ ssh -L YOUR_PORT_NUMBER:YOUR_NODE_ADDRESS:YOUR_PORT_NUMBER YOUR_EUID@vis-01.acs.unt.edu

```

For this example:

```
$ ssh -L 8888:gpu-8-7-1:8888 YOUR_EUID@vis-01.acs.unt.edu

```

### Access your Jupyter Notebook:

   Now to access the Jupyter Notebook, open any browser (Chrome,Mozilla etc) and type:

   ```
   http://localhost:YOUR_PORT_NUMBER
   ```

   In my case, my port number is 8888 so I will have to use:

   ```
   http://localhost:8888
   ```
   You will see a webpage like this:

   ![alt text](https://raw.githubusercontent.com/gmihaila/unt_hpc/master/misc/screenshot_loginwindow_jupyter.png)

   This is where you will enter your password that you created when you used

   ```
   $ jupyter notebook password
   ```

   Now you are inside your Jupyer Notebook on your local machine browser that runs on Talon! Cool!

   This is how mine looks like after login:

   ![alt text](https://raw.githubusercontent.com/gmihaila/unt_hpc/master/misc/screenshot_logged_jupyter.png)

   I only have bin folder in this image. Yours will be different, you will see all your directories from Talon.


### Enjoy!


### [< Jupyter Tutorial](https://github.com/gmihaila/unt_hpc)

### [< Main Page](https://github.com/gmihaila/unt_hpc)
